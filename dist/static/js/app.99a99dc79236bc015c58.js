(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"++F6":function(t,e,n){},"1AWv":function(t){t.exports=["in_theaters","coming_soon"]},"2kVO":function(t,e,n){"use strict";var i=n("++F6");n.n(i).a},"4qmQ":function(t,e,n){},7:function(t,e){},AkzS:function(t,e){t.exports=AMap},BvvS:function(t,e,n){},"Dqo/":function(t,e,n){},U88h:function(t,e,n){"use strict";var i=n("BvvS");n.n(i).a},UAeU:function(t,e,n){},Vtdi:function(t,e,n){"use strict";n.r(e);var i=n("oCYn"),a=n("L2JU"),s={changeVmin:function(t){t.vmin=Math.min(window.outerHeight,window.outerWidth)/100},changeCity:function(t,e){var n=e.city;t.city=n},changeBackUrl:function(t,e){var n=e.path;t.backUrl=n}},o=n("14Xm"),r=n.n(o),c=n("4d7F"),u=n.n(c),l=n("D3Ub"),p=n.n(l),m=n("AkzS"),v=n.n(m),f=void 0;try{f=new v.a.Geolocation({})}catch(t){console.log("AMP加载失败")}function d(t){return t&&(t instanceof u.a||"function"==typeof t.then)}var h=null,g={getCityName:function(t){var e=this,n=t.commit,i=(t.dispatch,t.state),a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return p()(r.a.mark(function t(){var s;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===i.city||a){t.next=2;break}return t.abrupt("return",u.a.resolve({city:i.city}));case 2:return d(h)||(h=new u.a(function(t,e){f.getCityInfo(function(n,i){console.log(i),"complete"===n&&t(i.city),"error"===n&&e(i.message)})})),t.next=5,h;case 5:return s=t.sent,n("changeCity",{city:"市"===String(s).slice(-1)?s.slice(0,-1):s}),h=null,t.abrupt("return",s);case 9:case"end":return t.stop()}},t,e)}))()}},b=n("m1cH"),y=n.n(b),_=n("QbLZ"),w=n.n(_),k=n("jo6Y"),x=n.n(k),C=n("AyUB"),L=n.n(C);function O(t){this.name="APILimitError",this.message=t,this.stack=(new Error).stack}O.prototype=L()(Error.prototype),O.prototype.constructor=O;var j=0,E=function(t){return j=0,t},S=function(t){throw j<5?j++:setTimeout(function(){j=0},1e3),new O("API访问次数达到上限")};function A(t,e){return i.default.http.jsonp("https://api.douban.com/v2"+t,e).then(E,S)}var R=n("1AWv"),U=function(t){var e=L()(null);return t.forEach(function(t){e[t]=null}),e}(R),V={getRatingList:function(t,e){var n=this,i=t.commit,a=(t.rootState,t.state),s=t.dispatch,o=e.type,c=e.refresh,u=void 0!==c&&c,l=x()(e,["type","refresh"]);return p()(r.a.mark(function t(){var e,c,p,m;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=w.a,t.next=4,s("getCityName",null,{root:!0});case 4:t.t1=t.sent,t.t2={city:t.t1},t.t3=l,l=(0,t.t0)(t.t2,t.t3);case 8:if(t.t4=d(U[o])&&!u,!t.t4){t.next=12;break}return t.next=12,U[o];case 12:return a[o].length,U[o]=A("/movie/"+o,{params:w()({},l,{start:u?0:a[o].length,count:l.count||10})}),t.prev=14,t.next=17,U[o];case 17:return e=t.sent,c=e.body,p=c.total,c.subjects.length,m=c.subjects,i("setRatingList",{type:o,refresh:u,data:m}),U[o]=void 0,t.abrupt("return",{isEnd:!(a[o].length<p)});case 27:if(t.prev=27,t.t5=t.catch(14),U[o]=void 0,!(t.t5 instanceof O)){t.next=33;break}return console.log(t.t5),t.abrupt("return",{error:!0,isEnd:!1});case 33:case"end":return t.stop()}},t,n,[[14,27]])}))()}},$={namespaced:!0,state:w()({},function(t){var e={};return t.forEach(function(t){e[t]=[]}),e}(R)),mutations:{setRatingList:function(t,e){var n,i=e.type,a=e.data;e.refresh?t[i]=a:(n=t[i]).push.apply(n,y()(a))}},actions:V};i.default.use(a.a);var z=new a.a.Store({strict:!1,state:{vmin:0,city:void 0,backUrl:""},mutations:s,actions:g,modules:{movieRatingList:$}}),F=n("jE9Z"),N=n("chKg"),B={name:"movie-item",props:{item:{required:!0,type:Object},index:{required:!0,type:Number},updated:{default:!1,type:Boolean},to:{default:"",type:String},isSlide:{default:!1,type:Boolean}},methods:{getStarPosition:function(t){return Math.round(t.rating.average)-10}},components:{swiperSlide:N.swiperSlide},watch:{}},P=(n("magV"),n("KHd+")),q=Object(P.a)(B,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(t.isSlide?"swiper-slide":"div",{tag:"component",staticClass:"movie-item"},[n("router-link",{attrs:{to:t.to}},[n("div",{staticClass:"img-wp"},[t.isSlide?n("img",{key:t.updated,ref:"img",attrs:{src:t.item.images.small,alt:""}}):n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.item.images.small,expression:"item.images.small"}],key:t.updated,ref:"img",staticClass:"slide-img",attrs:{alt:""}})]),t._v(" "),n("div",{staticClass:"movie-info"},[n("p",[t._v(t._s(t.item.title))]),t._v(" "),n("p",{class:["rating",{none:!t.item.rating.average}]},[n("span",{directives:[{name:"show",rawName:"v-show",value:t.item.rating.average,expression:"item.rating.average"}],staticClass:"rating-star",style:{"background-position-y":t.getStarPosition(t.item)+"rem"}}),t._v(" "),n("span",[t._v(t._s(t.item.rating.average?t.item.rating.average.toFixed(1):"暂无评分"))])])])])],1)},[],!1,null,"718f64f6",null);q.options.__file="movie-list-item.vue";var H=q.exports,I=(n("36R9"),{name:"home-movie-list",props:{type:{required:!0,type:String}},data:function(){return{updated:!0,swiperOption:{slidesPerView:"auto",touchMoveStopPropagation:!0,freeMode:!0,mousewheel:!0,pagination:{el:".swiper-pagination",clickable:!0}}}},computed:w()({},Object(a.d)("movieRatingList",{list:function(t){return t[this.type].slice(0,10)}}),Object(a.d)({city:"city"})),components:{swiper:N.swiper,movieListItem:H},methods:w()({},Object(a.b)("movieRatingList",["getRatingList"]),{getList:function(t){return this.getRatingList(w()({type:this.type},t))},refreshFade:function(){var t=this;this.updated=!1,this.$nextTick(function(){t.updated=!0})}}),created:function(){this.getList(),console.log(this)},watch:{city:function(t,e){var n=this;return p()(r.a.mark(function i(){return r.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if("in_theaters"!==n.type||void 0===e){i.next=5;break}return console.log(t,e),i.next=4,n.getList({refresh:!0});case 4:n.refreshFade();case 5:case"end":return i.stop()}},i,n)}))()}}}),X=(n("z6kr"),Object(P.a)(I,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home-movie-list-pane"},[n("p",{staticClass:"list-title"},[n("span",[t._t("title")],2),t._v(" "),n("router-link",{staticClass:"more",attrs:{to:{name:"movies-explore",params:{type:t.type}}}},[t._v("\n            更多\n        ")])],1),t._v(" "),n("swiper",{staticClass:"movie-list",attrs:{options:t.swiperOption}},t._l(t.list,function(e,i){return n("movie-list-item",{key:e.title,staticClass:"horizontal",attrs:{item:e,index:i,updated:t.updated,to:"/movie-detail/"+i,"is-slide":!0}})}))],1)},[],!1,null,"a2a7cc9a",null));X.options.__file="movie-list.vue";var M=X.exports,Y={name:"fake-search",data:function(){return{show:!0}},watch:{$route:function(t,e){this.show="home"===t.name||"search"===t.name||"movies-explore"===t.name}}},D=(n("wsz1"),Object(P.a)(Y,function(){var t=this.$createElement,e=this._self._c||t;return e("transition",{attrs:{name:"fade",mode:"out-in"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:this.show,expression:"show"}],staticClass:"fake-search-wrapper"},[e("div",{staticClass:"fake-search"},[e("span",[this._v("搜索电影")])])])])},[],!1,null,"09f2d320",null));D.options.__file="fake-search.vue";var K=D.exports,T={name:"home",components:{movieList:M,fakeSearch:K},mounted:function(){}},J=(n("plRA"),Object(P.a)(T,function(){var t=this.$createElement,e=this._self._c||t;return e("v-container",{staticClass:"container",attrs:{fluid:""}},[e("div",{staticClass:"movie-list-pane-wrapper"},[e("movie-list",{attrs:{type:"in_theaters"}},[e("template",{slot:"title"},[this._v("正在热映")])],2),this._v(" "),e("movie-list",{attrs:{type:"coming_soon"}},[e("template",{slot:"title"},[this._v("即将上映")])],2)],1)])},[],!1,null,"158aac8a",null));J.options.__file="home.vue";var Q=J.exports,W=n("P2sY"),Z=n.n(W);function G(t,e){!function(t,e){Z()(t.$data,e)}(t,x()(e,[]));var n=t.list.length;n<20&&t.getList({count:20-n})}var tt={props:{},name:"movies-explore",components:{fakeSearch:K,movieListItem:H},data:function(){return{loading:{},type:null,typeName:{in_theaters:"正在热映",coming_soon:"即将上映"}}},computed:w()({},Object(a.d)("movieRatingList",{list:function(t){return t[this.type]}})),beforeCreate:function(){},created:function(){},methods:w()({},Object(a.b)("movieRatingList",["getRatingList"]),{getList:function(t){var e=this;this.loading[this.type]||(this.loading[this.type]=!0,this.getRatingList(w()({type:this.type},t)).then(function(t){var n=t.isEnd;e.loading[e.type]=n}))}}),beforeRouteEnter:function(t,e,n){n(function(e){G(e,{type:t.params.type})})},beforeRouteUpdate:function(t,e,n){G(this,{type:t.params.type}),n()}},et=(n("2kVO"),Object(P.a)(tt,function(){var t,e=this,n=e.$createElement,i=e._self._c||n;return i("v-layout",{staticClass:"container",attrs:{column:""}},[i("h1",{staticClass:"title"},[e._v(e._s(e.typeName[e.type]))]),e._v(" "),i("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.getList,expression:"getList"}],attrs:{"infinite-scroll-disabled":!1,"infinite-scroll-distance":"20","infinite-scroll-immediate-check":"false"}},[i("v-container",e._b({staticClass:"movies-explore-wrapper",attrs:{fluid:""}},"v-container",(t={},t["grid-list-"+(e.$vuetify.breakpoint.width>1264?e.$vuetify.breakpoint.name:"lg")]=!0,t),!1),[i("v-layout",{staticClass:"movie-list",attrs:{row:"",wrap:"",tag:"ul",fluid:""}},e._l(e.list,function(t,e){return i("v-flex",{key:t.title,staticClass:"movie-item",attrs:{xs4:"",sm3:"",md2:"",tag:"li"}},[i("movie-list-item",{attrs:{item:t,index:e,to:"/movie-detail/"+e}})],1)})),e._v(" "),i("p",{staticClass:"text-xs-center always-loading"},[e._v("loading...")])],1)],1)])},[],!1,null,"03a8a6b9",null));et.options.__file="movies-explore.vue";var nt=et.exports,it={name:"not-found"},at=(n("zFHV"),Object(P.a)(it,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"not-found"},[e("p",{staticClass:"notice-chinese"},[this._v("没有找到这个东西")]),this._v(" "),e("p",[this._v("o(╥﹏╥)o")]),this._v(" "),e("v-btn",{staticClass:"el-button--success",attrs:{to:{name:"home"},tag:"v-btn ",color:"success"}},[this._v("\n        点击这里返回首页\n    ")])],1)},[],!1,null,"0c3c464e",null));at.options.__file="404.vue";var st=at.exports;i.default.use(F.a);var ot=new F.a({routes:[{path:"/",name:"home",component:Q,meta:{toHome:!1}},{path:"/explore/:type("+R.join("|")+")",name:"movies-explore",component:nt,props:function(t){return{type:t.params.type}}},{name:"not-found",path:"*",component:st}],scrollBehavior:function(t,e,n){return new u.a(function(t,e){setTimeout(function(){console.log(n),t(n||{x:0,y:0})},300)})},mode:"hash",base:function(){var t=location.pathname;return["/vue-douban/","/vue-douban/dist/","/douban/dist/"].find(function(e){return t.includes(e)})||"/"}()});ot.beforeEach(function(t,e,n){var i=e.name,a=e.path;z.commit("changeBackUrl",{path:i&&"/"!==a?"":"/"}),n()});var rt=ot,ct=n("KN3F"),ut=n("KD6U"),lt=n.n(ut),pt=n("SHqN"),mt=n.n(pt),vt=n("zlta"),ft=n.n(vt),dt=(n("0eeA"),n("v0CA"),n("wrEB"),{name:"nav-header",data:function(){return{isFixed:!1}},components:{fakeSearch:K},computed:w()({},Object(a.d)(["backUrl"])),methods:{searchFade:function(){var t=this;window.IntersectionObserver&&(console.log(IntersectionObserver),new IntersectionObserver(function(e,n){var i=e[0].intersectionRatio;t.isFixed=i<36/66},{threshold:36/66}).observe(this.$refs.navigator))},back:function(){"home"!==this.$route.name&&(this.backUrl?this.$router.push({path:this.backUrl}):this.$router.go(-1))}},beforeCreate:function(){},mounted:function(){}}),ht=(n("U88h"),Object(P.a)(dt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-toolbar",{ref:"navigator",staticClass:"navigator",class:{fixed:t.isFixed},attrs:{app:"",flat:""}},[n("span",[n("v-btn",{staticClass:"toolbar-btn",attrs:{icon:""},on:{click:t.back}},["home"!==t.$route.name?n("v-icon",[t._v("\n            arrow_back\n        ")]):t._e()],1)],1),t._v(" "),n("v-toolbar-title",{staticClass:"toolbar-title",domProps:{textContent:t._s("豆瓣电影")}}),t._v(" "),n("a")],1)},[],!1,null,"84e61674",null));ht.options.__file="nav-header.vue";var gt=ht.exports,bt=n("sEfC"),yt=n.n(bt),_t=Object(a.c)(["changeVmin"]).changeVmin,wt=yt()(_t,250),kt={name:"App",created:function(){this.changeVmin()},mounted:function(){window.addEventListener("resize",this.getVmin)},methods:w()({},Object(a.b)(["getCityName"]),{changeVmin:_t,getVmin:wt}),components:{navHeader:gt,fakeSearch:K}},xt=(n("XAuw"),Object(P.a)(kt,function(){var t=this.$createElement,e=this._self._c||t;return e("v-app",{attrs:{id:"app",direction:"vertical"}},[e("nav-header"),this._v(" "),e("v-content",[e("fake-search"),this._v(" "),e("transition",{attrs:{name:"fade",mode:"out-in"}},[e("keep-alive",[e("router-view",{staticClass:"main-panel"})],1)],1)],1)],1)},[],!1,null,null,null));xt.options.__file="App.vue";var Ct=xt.exports;i.default.use(ct.a),i.default.use(mt.a),i.default.use(lt.a,{preLoad:1.5,attempt:5,observer:!0}),i.default.use(ft.a),i.default.config.productionTip=!1,new i.default({el:"#app",router:rt,store:z,components:{App:Ct}})},XAuw:function(t,e,n){"use strict";var i=n("YkXb");n.n(i).a},YkXb:function(t,e,n){},dfhX:function(t,e,n){},magV:function(t,e,n){"use strict";var i=n("Dqo/");n.n(i).a},p2VC:function(t,e,n){},plRA:function(t,e,n){"use strict";var i=n("p2VC");n.n(i).a},wrEB:function(t,e,n){},wsz1:function(t,e,n){"use strict";var i=n("UAeU");n.n(i).a},z6kr:function(t,e,n){"use strict";var i=n("dfhX");n.n(i).a},zFHV:function(t,e,n){"use strict";var i=n("4qmQ");n.n(i).a}},[["Vtdi",3,1,2]]]);
//# sourceMappingURL=app.99a99dc79236bc015c58.js.map